% backup

\documentclass[sigconf]{acmart}
\settopmatter{printacmref=true}
\fancyhead{}
\usepackage{algorithm, pseudocode}
\usepackage{booktabs} 
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{etex}
\usepackage{color}
\usepackage{graphicx}
\usepackage{esint}
%\usepackage{stmaryrd}
\usepackage{tabularx}
\usepackage{multirow}
%\usepackage[squaren]{SIunits}
\usepackage[tight]{subfigure}
\usepackage{multirow}
\usepackage{mathtools}
\usepackage[noend]{algpseudocode}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{chngcntr}
\usepackage{titlesec}

\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{claim}{Claim}
\newtheorem{sketch}{Sketch of Proof}
\newtheorem{example}{Example}
\newtheorem{problem}{Problem}

\newcommand{\M}{\mathsf{M}}

\newcommand{\A}{\mathbb{A}}
\newcommand{\Q}{\mathbb{Q}}
\renewcommand{\P}{\mathbb{P}}
\newcommand{\K}{\mathbb{K}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\renewcommand{\L}{\mathbb{L}}
\newcommand{\ang}[1]{\{#1\}}
\newcommand{\mb}{\overline{\mathcal{M}}}
\newcommand{\mm}{\mathcal{M}}
\newcommand{\ee}{\mathcal{L}}
\newcommand{\kk}{\mathcal{K}}
\newcommand{\lm}{\textnormal{lm}}
\newcommand{\rr}{\mathcal{R}}
\newcommand{\pp}{\mathcal{P}}
\newcommand{\ints}{\mathbb{Z}}
\newcommand{\cN}{\mathcal{N}}
\newcommand{\ar}{\mathcal{A}}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\la}{\left\langle}
\newcommand{\ra}{\right\rangle}
\newcommand{\red}{\textnormal{red}}
\newcommand{\cor}{\textnormal{Corr}}
\newcommand{\pe}{\textnormal{Per}}
\newcommand{\inn}{\textnormal{Inn}}
\newcommand{\reg}{\textnormal{reg}}
\newcommand{\supp}{\textnormal{supp}}
\newcommand{\mut}{\textnormal{MutNorm}}
\newcommand{\bas}{\textnormal{base}}
\newcommand{\ngen}{\textnormal{NormGen}}
\newcommand{\intt}{\textnormal{Int}}
\newcommand{\gen}{\textnormal{gen}}
\newcommand{\norm}{\textnormal{norm}}
\newcommand{\maxn}{\textnormal{MaxNorm}}
\newcommand{\act}{\textnormal{act}}
\newcommand{\aff}{\mathbb{A}}
\newcommand{\affn}{\mathbb{A}^n}
\newcommand{\spa}{\textnormal{ }}
\newcommand{\lcm}{\textnormal{lcm}}
\newcommand{\divi}{\textnormal{div}}
\newcommand{\Reg}{\textnormal{Reg}}
\newcommand{\spec}{\textnormal{Spec}}
\newcommand{\conv}{\textnormal{Conv}}
\newcommand{\cone}{\textnormal{Cone}}
\newcommand{\minpol}{\textnormal{MinPoly}_{\mathbb{F}_q}}
\newcommand{\modu}{\textnormal{ mod }}
\newcommand{\frakf}{\mathfrak{f}}
\newcommand{\frakp}{\mathfrak{p}}
\newcommand{\frakr}{\mathfrak{r}}
\newcommand{\softO}{O\tilde{~}}
\newcommand{\sring}{\L\{\tau\}}
\newcommand{\comm}{\mathbb{F}_q[\tau^n]}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}
% \newcommand{\todo}{{\bf todo:}~}

\setcopyright{rightsretained}


% DOI
%% \acmDOI{10.475/123_4}
% ISBN
%% \acmISBN{123-4567-24-567/08/06}
%Conference
%% \acmConference[WOODSTOCK'97]{ACM Woodstock conference}{July 1997}{El Paso, Texas USA}
%% \acmYear{2019}
%% \copyrightyear{2019}
%% \acmArticle{4}
%% \acmPrice{15.00}


%\acmDOI{?/?}
%\acmISBN{?}
%\acmConference[ISSAC]{International Symposium on Symbolic and Algebraic Computation}{2019}{Beijing}
%\acmYear{2019}
%\copyrightyear{2019}
%\acmPrice{??.??}

\begin{document}
\copyrightyear{2019} 
\acmYear{2019} 
\setcopyright{acmlicensed}
\acmConference[ISSAC '19]{International Symposium on Symbolic and Algebraic Computation}{July 15--18, 2019}{Beijing, China}
\acmBooktitle{International Symposium on Symbolic and Algebraic Computation (ISSAC '19), July 15--18, 2019, Beijing, China}
\acmPrice{15.00}
\acmDOI{10.1145/3326229.3326256}
\acmISBN{978-1-4503-6084-5/19/07}
\title{Minimal Polynomials of Finite Drinfeld Modules in any Rank}

\author{Yossef Musleh}
\affiliation{%
  \institution{Cheriton School of Computer Science \\ University of Waterloo}
  \city{Waterloo}
  \state{Ontario}
  \country{Canada}
}
\email{ymusleh@uwaterloo.ca}

\author{\'Eric Schost}
\affiliation{%
  \institution{Cheriton School of Computer Science \\ University of Waterloo}
    \city{Waterloo}
  \state{Ontario}
  \country{Canada}
}
\email{eschost@uwaterloo.ca}



\begin{abstract}

\end{abstract}


\setcounter{secnumdepth}{4}
\renewcommand{\theparagraph}{\thesubsection.\arabic{paragraph}}
\counterwithin{paragraph}{subsection} % makes paragraph depend on subsection
\titleformat{\paragraph}[runin]{\normalfont\normalsize\bfseries}{\theparagraph.}{1em}{}
\titlespacing*{\paragraph}{0em}{1ex}{1em}
\newcommand{\pref}[1]{{\bf\ref{#1}}}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Introduction}

Elliptic Modules, later \textit{Drinfeld Modules}, were originally introduced in ~\cite{Drinfeld74} as a theoretical tool for solving a special case of the Langlands Conjecture. Since then, their relationship with certain classical objects, and in particular the close analogy between rank-two Drinfeld modules and elliptic curves, has led to 

\section{Preliminaries}

\subsection{Elementary Constructions}
To allow for consistency with the notation used in ~\cite{MuslehSchost}, $\F_q$ will denote a finite field of order $q$ a prime power, and $\L \supset \F_q$ shall denote a finite extension of degree $n$. $\L$ comes with an implicit isomorphism $\L \mapsto \F_q[x]/\frakp := \F_{\frakp}$. Moreover, given any homomorphism $\gamma: \L \to \F_q[x]$, its kernel $\ker(\gamma)$ is a prime ideal generated by a monic irreducible polynomial $\mathfrak{p}$. We refer to $\mathfrak{p}$ as the $\mathbb{F}_q[x]$-characteristic of $\L$.

The ring of \textit{skew-polynomials} is defined as the set:

\begin{align}
    \L\{\tau\} = \bigg\{ \sum_{i=0}^su_i\tau^i \textnormal{ | } s \in \N, u_i \in \L \bigg\}.
\end{align}

Subject to the relation $\tau a = \pi(a) \tau$

\subsection{Drinfeld Modules}

We are now ready to define the notion of a Drinfeld module.

\begin{definition}
A \emph{Drinfeld module} over $(\L, \gamma)$ is a ring homomorphism $\phi: \F_q[x] \to L\{ \tau \}$ such that:
\end{definition}

\begin{equation}\label{definition}
    \phi_x = \Delta_r \tau^r + \ldots + \Delta_1 \tau + \gamma(x)
\end{equation}

The largest index $r$ such that $\Delta_r \neq 0$ is the \textit{rank} of the Drineld module. We shall specify a Drinfeld module over $\F_q[x]$ by its coefficients given in (\ref{definition}). The \textit{minimal polynomial} of a Drinfeld module is the smallest degree monic polynomial $x^r + \sum_{i=0}^{r - 1} a_ix^i \in \F_q[x]$ such that:

\begin{equation}\label{characteristic}
    \tau^{nr} + \phi_{a_{r-1}}\tau^{n(r-1)} + \ldots + \phi_{a_1} \tau^n + \phi_{a_0} = 0
\end{equation}

Where $\deg a_i \leq \frac{(r - i)n}{r}$. We will be primarily concerned with algorithms computing the coefficients $\{ a_i \}_{i=0}^{r-1}$. An explicit formula to compute $a_0$ is given in \cite{GaPa18}:

\begin{equation}\label{norm}
    a_0 = (-1)^{r + n(r+1)}N_{\F_{\mathfrak{p}}/\F_q}(\Delta_r)^{-1} \mathfrak{p}
\end{equation}

\subsection{Revisiting the Rank-Two Case}

The problem of computing characteristic polynomials, which coincide with the minimal polynomial, of rank-2 Drinfeld modules $\phi_x = \Delta_2 \tau^2 + \Delta_1 \tau + \gamma(x)$ was first extensively studied in \cite{gekeler} where two algorithms were proposed. The first is a generic algorithm that computes the minimal polynomial of any rank 2 Drinfeld module by using a recurrence to compute the coefficients of $\phi_{x^i}$ for $i \leq \frac{n}{2}$, which allows the computation of the coefficients of $a_1$ using (\ref{characteristic}), and takes $\tilde{O}(n^3 \log p)$ bit operations. The second algorithm uses an analog of the Hasse invariant $H$ for Drinfeld modules defined as the coefficient of $\tau^m$ in $\phi(\frakp)$. When $\L = \F_q$, $a_1$ can be written as

\begin{equation*}
    a_1 = (-1)^n N_{\L/\F_q}(\Delta_2)^{-1}H
\end{equation*}

$H$ itself may be computed using a single recurrence which allows an $\tilde{O}(n^{2 + \epsilon} \log^{1 + o(1)} q)$ bit complexity

\subsubsection{Schoof-Like Algorithm} Inspired by Schoof's algorithm for elliptic curves, this approach aims to compute $a_1 \mod \psi$ for irreducibles $\psi \in \F_q[x]$ and reconstruct $a_1$ using the Chinese Remainder Theorem. We may reduce equation (\ref{characteristic}) on the right by $\phi_{\psi}$ to obtain

\begin{equation*}
    \tau^{2n} + (\phi_{a_1 \textnormal{ mod } \psi}) \tau^n + \phi_{a_0 \textnormal{ mod } \psi} = 0
\end{equation*}

Choosing irreducibles $\psi_1, \ldots, \psi_s$ with $\sum_{i=1}^s \deg \psi_i > n/2$ and $\deg \psi_i \in O(\log n)$ for all $i$, the algorithm computes $\tau^n \mod \phi_{\psi_i}$ and $\phi_{a_0 \textnormal{ mod } \psi_i}$ and solves for $a_1 \mod \psi_i$ using the characteristic equation. Performing this operation $s$ times and reconstructing $a_1$ runs at an overall cost $(n^2\log q + n \log^2 q)^(1 + o(1))$.

\subsubsection{Minimal Polynomials from Hankel Systems} Starting with the characteristic equation $\phi_{a_1} = -\tau^{2n} - \phi_{a_0}$, set $\phi_{a_1} := \sum_{i=0}^{\lfloor n/2 \rfloor} c_i\phi_{x}^i$ and $r := -\tau^{2n} - \phi_{a_0}$. For a uniformly random $\alpha \in \L$, apply operators $a_1$ and $r$:

\begin{equation*}
    \sum_{i=0}^{\lfloor n/2 \rfloor} c_i\phi_{x}^i(\alpha) = r(\alpha)
\end{equation*}

For any $j > 0$, apply $\phi_x^j$ to the preceding expression

\begin{equation*}
    \sum_{i=0}^{\lfloor n/2 \rfloor} c_i\phi_{x}^{i +j}(\alpha) = \phi_x^jr(\alpha)
\end{equation*}

After applying a uniformly random projection $\ell : \L \to \F_q$, each such expression yields a row in the $\nu \times \nu$ Hankel system over $\F_q$:

\begin{equation*}
    \begin{bmatrix}
    \ell(\alpha) & \ldots & \ell(\phi_x^{\nu - 1}(\alpha)) \\
    \ell(\phi_x(\alpha)) & \ldots & \ell(\phi_x^{\nu}(\alpha)) \\
    \vdots & & \vdots \\
    \ell(\phi_x^{\nu - 1}(\alpha) & \ldots & \ell(\phi_x^{2\nu - 2}(\alpha)
    \end{bmatrix}
    \begin{bmatrix}c_0 \\ \vdots \\ c_{\nu - 1} \end{bmatrix} = 
    \begin{bmatrix} \ell (r(\alpha)) \\ \vdots \\ \ell(\phi_x^{\nu - 1}r(\alpha)) \end{bmatrix}
\end{equation*}

If $n$ is even, we may not be able to determine $c_{\lfloor n/2 \rfloor}$, in which case we let $\nu = \lfloor n/2 \rfloor$ and compute $c_{\lfloor n/2 \rfloor}$ via the formula
\begin{equation*}
    c_{\lfloor n/2 \rfloor} = \textnormal{Tr}_{\F_{q^2}/\F_{q}}(\textnormal{N}_{\L/\F_{q^2}}(\Delta)^{-1})
\end{equation*}
Where $\F_{q^2}$ is the unique quadratic extension of $\F$ contained in $\L$, and $\textnormal{Tr}$ and $\textnormal{N}$ are the field trace and norm respectively. One can compute up to $2n$ elements of the sequence $\{ \ell \phi_x^i(\alpha)\}$ using $(n^2 \log^2q)^{1 + o(1)}$ bit operations 

%\begin{equation*}
%    \phi_x^i\tau^{2n} + \phi_
%\end{equation*}

\section{Minimal Polynomials in Higher Ranks}

\subsection{Previous Work}

The following approach is due to \cite{GaraiPapikian}. Define:

\[ f_i = \phi_{r-i}\tau^{n (r-i)} + \phi_{a_{r - i -1 }}\tau^{n (r-i-1)} + \ldots + \phi_{a_0} \]

\[ f_i' = \tau^{nr} + \phi_{a_{r -1 }}\tau^{n (r-1)} + \ldots + \phi_{a_{r-i + 1}}\tau^{{r - i + 1}} \]

Observe that the lowest skew-degree of any term in $\phi_{a_j}\tau^{nj}$ is $n_j$, whose constant term is exactly $\gamma(a_j)$; consequently $\gamma(a_{r-i+1}) \tau^{n(r-i + 1)}$ is the unique term of $f_i'$ with skew degree $n(r - i + 1)$. Since $f_i + f_i' = 0$, we must have that $-\gamma(a_{r-i+1})}$ is the coefficient of the $n(r - i + 1)$ skew-degree term of $f_i$, which allows the recursive computation of each $f_i$.

In a bit-complexity model it is possible to compute all of $\phi_T, \phi_{T^2}, \ldots, \phi_{T^n}$ in $\Theta(r\log(r)n^3\log(q))$ operations. Computing each $f_i$ is linear in the degree of the term being added, which is $O(rn)$, which is done for $O(r)$ iterations, so the overall cost is $O((r^2n + r\log(r)n^3)\log(q) )$.

\subsection{Schoof-like Algorithms}

Recall the \textit{minimal polynomial} of $\phi$ is the unique monic polynomial $X^r - a_{r-1}X^{r-1} - \ldots - a_1X - a_0$ of least degree such that:

\begin{equation} \label{charpoly1}
 \tau^{nr} + \phi_{a_{r-1}}\tau^{n(r-1)} + \ldots + \phi_{a_1} \tau^n + \phi_{a_0} = 0
\end{equation}


The goal is to compute each $a_i$ modulo a set of polynomials which can then be used to reconstruct the true coefficients. As argued previously, when $q >> nr$, linear polynomials suffice and equation (\ref{charpoly1}) becomes:

\begin{equation}
\tau^{nr} - a_{r-1}(e)\tau^{n(r-1)} - \ldots - a_1(e)\tau^n - a_0(e)  = 0 \mod \phi_{T - e}
\end{equation}

Writing this in matrix form:

\begin{equation}\label{system1} \begin{bmatrix} \tau^{n(r-1)} & \ldots & \tau^{n} \end{bmatrix} \begin{bmatrix} a_{r-1}(e) \\ \vdots \\ a_1(e) \end{bmatrix}} = \tau^{nr} - a_0(e) \mod \phi_{T-e}
\end{equation}

Fixing a computational basis for $\L\{\tau\}/\phi_{T - e}$ over $\F_q$, the entries of the matrix $B_{\phi}^{n,r} := \begin{equation} \begin{bmatrix} \tau^{n(r-1)} & \ldots & \tau^{n} \end{bmatrix} \mod \phi_{T-e}$ are a polynomial in the coefficients of the modulus $\phi_{T-e}$. The goal is to show the system is solvable generically by applying the Schwartz-Zippel lemma to $\det B_{\phi}^{n,r}$. We first bound the degree of the determinant with the following lemma.

\begin{lemma}
$\deg \textnormal{det }  B_{\phi}^{n,r} \leq nr^2$.
\end{lemma}

\begin{proof}
Set $\alpha_i = \frac{\Delta_i}{\Delta_r}$ with coefficients $\alpha_i := \sum_{j=0}^{n-1}\alpha_{i,j}T^j$. Furthermore, let $\overline{\alpha_i}: \F_q^n \to \F_q^n $ be the $n\times n$ matrix of the action of left multiplication by $\alpha_i$ on $\L/\F_q$, and let $\overline{\tau}: \F_q^n \to \F_q^n$. If $\sum_{i=0}^{r-1}c_i \tau^i$ is any skew polynomial, the action of left multiplication by $\tau$ on $L[\tau]/\phi_{T-e}$ is given by the following matrices:

\begin{equation*}
M :=  \begin{bmatrix}\overline{\alpha}_{r-1} & I & 0 & \ldots & 0 \\ \overline{\alpha}_{r-2} & 0 & I & \ldots & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots \\ \overline{\alpha}_{0} & 0 & 0 & \ldots & I \end{bmatrix} \hspace{4mm} S := \begin{bmatrix} \tau & & \\ & \ddots & \\ & & \tau \end{bmatrix}
\end{equation*}

\begin{equation*}

\begin{bmatrix}\overline{\alpha}_{r-1} & I & 0 & \ldots & 0 \\ \overline{\alpha}_{r-2} & 0 & I & \ldots & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots \\ \overline{\alpha}_{0} & 0 & 0 & \ldots & I \end{bmatrix} \begin{bmatrix} \tau & & \\ & \ddots & \\ & & \tau \end{bmatrix} \begin{bmatrix} c_{r-1} \\ \vdots \\ c_{0} \end{bmatrix} = \begin{bmatrix} \overline{\alpha}_{r-1} \tau(c_{r-1}) + \tau(c_{r-2}) \\ \overline{\alpha}_{r-2} \tau c_{r-1} + \tau c_{r-3} \\ \vdots \\ \overline{\alpha}_{0} \tau(c_{r-1})  \end{bmatrix}
\end{equation*}

With each $c_i \in L$ being written as a size $n$ vector in $\mathbb{F}_q$. Then $\tau^{i} \mod \phi_{T-e}$ is given by 

\begin{equation*}
(MS)^{in-r} \begin{bmatrix} 1 \\ 0 \\ \vdots \\ 0 \end{bmatrix}.
\end{equation*}

The entries of this expression have degree $in - r$ in the coefficients $\alpha_{i,j}$, and the total degree is $\sum_{i=1}^{r-1} in - r \leq nr^2$.

\end{proof}

If $\textnormal{det} B_{\psi}^{n,r} $ is not exactly 0, then

\begin{equation*}
    \Pr\Big[\textnormal{det} \begin{bmatrix} \tau^{n(r-1)} & \ldots & \tau^{n} \end{bmatrix} = 0\Big] \leq \frac{nr^2}{q}
\end{equation*}

We now aim to classify pairs of parameters $n,r$ for which there exists at least one choice of modulus $\psi$ that guarantees a non-zero determinant. In the case where $\gcd(n,r) = 1$ we may take $\psi = \tau^n - 1$.
\begin{theorem}
If $r = 3$, then for any $n$ there exists a skew-polynomial $\psi$ such that $\det B^{n,3}_{\psi} \neq 0$.
\end{theorem}
\begin{proof}
The notion of an \textit{Azumaya algebra} and their connection to skew polynomials was previously studied in \cite{Ikehata1984AzumayaAA} and \cite{skewfactor}. In particular, we are interested in the construction of the \textit{reduced norm} which induces a map $\cN: \L\{\tau\} \to \comm$ sending $\sring$ into its center while satisfying the following constraints.

\begin{enumerate}
    \item $\cN(\psi_1 \psi_2) = \cN(\psi_1) \cN(\psi_2)$
    \item $\deg \cN(\psi) \leq n \deg \psi$
    \item $\cN(\psi) = \psi^n$ if $\psi \in \L[\tau^n]$
    \item $\psi$ is irreducible in $\sring$ if and only if $\cN(\psi)$ is irreducible in $\L[\tau^n]$
\end{enumerate}

For details on the construction of the map and the proof of item (4) we refer to \cite{skewfactor}. Supposing that there is a $\lambda \in \F_q$ such that $\tau^{n} - \lambda = 0 \mod \psi$, we must have a skew-polynomial $D$ such that $\tau^n - \lambda = D \psi$. Taking reduced norms of both sides leads to

\begin{equation*}
(\tau^n - \lambda)^n = \cN(D)\cN(\psi)
\end{equation*}

The following observation shows that we may always find an irreducible degree 3 skew-polynomial in $\L\{\tau\}$. If there are none, then the mapping of triples $(\alpha, \beta, \gamma) \to (a, b, c)$ from $\L^3$ implied by $(\tau^2 + \alpha \tau + \beta)(\tau + \gamma) = \tau^2 + a \tau^2 + b\tau + c$ must be bijective. However both $(3, 2, 1)$ and $(2, 1, 2)$ map to $(4, 5, 2)$ and that this holds in any characteristic.  If we choose $\psi$ to be any degree 3 skew-polynomial irreducible in $\L\{\tau \}$, which must exist if $\L$ is finite, item (4) implies $\cN(\psi)$ is an irreducible central skew-polynomial dividing $(\tau^n - \lambda)^n$ and so $\cN(\psi) = \tau^n - \lambda$. But we must then have $n^2 = \deg \cN(D) + \deg \cN(\psi) \leq (n-3)n + n = n^2 - 2n < n^2$, giving a contradiction.

\end{proof}

\subsubsection{Complexity.}

The algorithm can be summarized with the following routine:

\begin{enumerate}
    \item Compute $\tau^{ni} \mod \phi_{T-e}$ in the computational basis for $\lfloor\frac{r-1}{r}n \rfloor$ distinct $e \in \F_q$ and $1 \leq i \leq r$
    \item Solve the $r \times (r-1)$ system given in (\ref{system1}) for each choice of $e$. If $\textnormal{det} B_{\psi}^{n,r} \neq 0$, apply a uniformly random projection $\ell : \L \to \F_q$ to the system and solve the system over $\F_q$.
    \item Interpolate $a_i$ using the evaluation points $a_i(e)$ computed in step (2). 
\end{enumerate}

The computationally intensive component is step (1), which can be completed using the companion matrix method in conjunction with fast modular composition using $r^{\omega+1}(n^2 \log q)^{1 + o(1)}$ bit operations. Step (2) adds $r^{\omega}n\log q$ bit operations, and (3) is of negligible cost.

\section{From Hankel Systems}

Inspired by the Monte Carlo Algorithm given in $\cite{MuslehSchost}$, we can organize the characteristic equation into a Hankel system.

\begin{equation*}
\sum_{i=1}^{r - 1} \phi_{a_i}\tau^{ni} = \tau^{nr} - \phi_{a_0}
\end{equation*}
\begin{equation}\label{chareq}
\sum_{i=1}^{r - 1} \sum_{j=0}^{n(r-i)/r}a_{i,j}\phi_{T}^j\tau^{ni} = \tau^{nr} - \phi_{a_0}
\end{equation}

Consider the operator Hankel blocks
\begin{equation*}
H_{u,v} = \begin{bmatrix}
\phi_T^u\tau^{n} & \phi_T^u\tau^{2n} & \ldots & \phi_T^u\tau^{n\lfloor r - (ur)/n \rfloor} \\
\phi_T^u\tau^{2n} & \phi_T^u\tau^{3n} & \ldots & \phi_T^u\tau^{(1 +\lfloor r - (ur)/n \rfloor)n} \\ \vdots & \vdots & \ddots & \vdots \\ \phi_T^u\tau^{vn} & \phi_T^u\tau^{(1+v)n} & \ldots & \phi_T^u\tau^{(v + \lfloor r - (ur)/n \rfloor) n}
\end{bmatrix}
\end{equation*}
\begin{equation*}
    G_{v} = \begin{bmatrix}
    \tau^{nr} - \phi_{a_0} & \tau^{n(r+1)} - \phi_{a_0}\tau^n & \ldots \tau^{n(r+v -1)} - \phi_{a_0}\tau^{n(v-1)}
    \end{bmatrix}^T
\end{equation*}

Define
\begin{equation*}
H:= \begin{bmatrix}
H_{0,v_1} & H_{1, v_1} & \ldots & H_{n\lfloor r/r-1 \rfloor, v_1} \\ \vdots & \vdots & \ddots & \vdots \\ H_{0,v_k} & H_{1, v_k} & \ldots & H_{n\lfloor r/r-1 \rfloor, v_k}
\end{bmatrix}
\end{equation*}

We thus obtain the system

\begin{equation}
%\begin{bmatrix}
%H_{0,v_1} & H_{1, v_1} & \ldots & H_{n\lfloor r/r-1 \rfloor, v_1} \\ \vdots & \vdots & \ddots & \vdots \\ H_{0,v_k} & H_{1, v_k} & \ldots & H_{n\lfloor r/r-1 \rfloor, v_k}
%\end{bmatrix}
H
\begin{bmatrix}
a_{1,0} \\ a_{2,0} \\ \vdots \\ a_{1,1} \\ a_{2,1} \\ \vdots \\ a_{1, n\lfloor (r-1)/r \rfloor}
\end{bmatrix} = 
\begin{bmatrix}
G_{v_1} \\ \vdots \\ G_{v_k}
\end{bmatrix}
\end{equation}

We lift to an extension $K$ over $L$; goal is to choose a set of evaluation points $\alpha_1, \ldots, \alpha_k \in K$ such that

\begin{equation*}
    H(\alpha_1, \ldots, \alpha_k) := \begin{bmatrix}
H_{0,v_1}(\alpha_1) & H_{1, v_1}(\alpha_1) & \ldots & H_{n\lfloor (r-1)/r \rfloor, v_1}(\alpha_1) \\ \vdots & \vdots & \ddots & \vdots \\ H_{0,v_k}(\alpha_k) & H_{1, v_k}(\alpha_k) & \ldots & H_{n\lfloor (r-1)/r\rfloor, v_k}(\alpha_k)
\end{bmatrix}
\end{equation*}

is non-singular. Note that $H$ is an $nr \times (v_1 + \ldots + v_k) $ system, and we take $v_1 = v_2 = \ldots = v_k = n$, $k = r$, and $[K:L] = r$. So $[K:\F_q] = nr$, and observe that if the following two conditions are satisfied:

\begin{enumerate}
    \item The characters $\phi_T^{u}\tau^{ni}$ on $K$ are independent for $1 \leq i \leq r-1$ and $0 \leq u \leq  \frac{r-i}{r} n < n$ 
    \item The set $B = \{\alpha_1, \tau^n(\alpha_1), \ldots , \tau^{n(r - 1)}(\alpha_1), \ldots , \alpha_k, \tau^n(\alpha_k), \ldots , $
    $\tau^{n(r - 1)}(\alpha_k) \}$ is a basis for $K/\F_q$
\end{enumerate} 

Then $H(\alpha_1, \ldots, \alpha_{n})$ must be non-singular. The following lemma summarizes the core of this argument.

\begin{lemma}\label{charindlem}
Let $F/G$ be a finite field extension with $[F:G] = m$ and fix a basis $\alpha_1, \ldots, \alpha_m$ for $F$ over $G$. Let $\sigma_1, \ldots, \sigma_m$ be independent characters over $F$, fixing $G$, and which act linearly on $F$. Then the following matrix is non-singular

\begin{equation*}
 \begin{bmatrix}
\sigma_1(\alpha_1) & \ldots & \sigma_m(\alpha_1) \\ \vdots & & \vdots \\ \sigma_1(\alpha_m) & \ldots & \sigma_m(\alpha_m) 
\end{bmatrix}   
\end{equation*}


\end{lemma}
\begin{proof}
Suppose there exist $\Lambda = \begin{bmatrix} \lambda_1 &  \ldots & \lambda_m \end{bmatrix}^T \in F^m$ with not all $\lambda_i = 0$ such that

\begin{equation*}
 \begin{bmatrix}
\sigma_1(\alpha_1) & \ldots & \sigma_m(\alpha_1) \\ \vdots & & \vdots \\ \sigma_1(\alpha_m) & \ldots & \sigma_m(\alpha_m) \end{bmatrix} \begin{bmatrix} \lambda_1 \\ \vdots \\ \lambda_m \end{bmatrix} = \begin{bmatrix}
0 \\ \vdots \\ 0
\end{bmatrix}
\end{equation*}

Then for any row-wise re-scaling with $\ell_1, \ldots, \ell_m \in G$ we must also have

\begin{equation*}
 \begin{bmatrix}
\ell_1\sigma_1(\alpha_1) & \ldots & \ell_1\sigma_m(\alpha_1) \\ \vdots & & \vdots \\ \ell_m\sigma_1(\alpha_m) & \ldots & \ell_m\sigma_m(\alpha_m) \end{bmatrix} \begin{bmatrix} \lambda_1 \\ \vdots \\ \lambda_m \end{bmatrix} = \begin{bmatrix}
0 \\ \vdots \\ 0
\end{bmatrix}
\end{equation*}

We multiply out the left-hand side and sum the rows to obtain

\begin{equation}\label{violation}
    \sum_{i=1}^m\sum_{j=1}^m\ell_i\lambda_j\sigma_j(\alpha_i) = \sum_{j=1}^m\lambda_j\sigma_j\bigg(\sum_{i=1}^m\ell_i\alpha_i\bigg)  = 0
\end{equation}

Observe now that (\ref{violation}) holds for any $\ell_1, \ldots, \ell_m $, violating independence of characters.

\end{proof}

If $\gcd(n,r) = 1$, the degree of the lead term of $\phi_T^u = C\tau^{ru} + \ldots$ has a unique residue modulo $n$ for distinct choices of $u$, and so independence of $\{ \phi_T^{u}\tau^{ni} \}_{0 \leq u \leq n(r-i)/r }^{1 \leq i < r}$ follows from independence of $id, \tau, \tau^2, \ldots, \tau^{nr-1}$. The values $\alpha_1, \ldots, \alpha_r$ can be constructed from a normal basis for $K/\F_q$ by selecting $\alpha_i = \alpha^{q^i}$ for $0 \leq i \leq r - 1$.

\subsubsection{Complexity.} Constructing the Hankel system above involves computing $\phi_T^{u}\tau^{ni}(\alpha_j)$ for $O(nr^2)$ choices of $0 \leq u < n, 1 \leq i \leq r, 0 \leq j \leq r$. The applications of $\tau$ can be applied for $O(1)$ cost on the normal basis, so the total bit complexity is $O(n^2r^3\log q)$ for constructing the Hankel system. We may again apply a uniformly selected linear projection $\ell: K \to \F_q$ at an additional cost of $O(n^2r^3\log q)$. Constructing the normal basis and solving the resulting $nr \times nr$ Hankel system consisting of $n$ block columns and $r$ block rows can be done in at most $O(n^2r^2\log q)$










%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{ACM-Reference-Format}
\bibliography{drinfeld_charpoly}

\end{document}
